body common control {

  bundlesequence => {
                      "main",

                    };

  inputs => {
              "../../../libraries/copbl/cfengine_stdlib.cf",
              "main.cf",
            };
}

bundle agent main {
vars:
  "tmux_config" slist => {
                           "unbind ^A",
                           "bind ^A select-pane -t :.+",
                         };
methods:

# Ensure a tmux session by the name of 'top' exits in any context running as the user 'cmdln'
# use default values for tmux_bin and su_bin
# execute the command /usr/bin/htop in the session
# Use the config /tmp/tmux.conf with only the specified entries (context_conf_empty_first is set to any)
"any" usebundle => utilities_tmux_sessionmanager(
                                                  "main.prefix",          # prefix
                                                  "bundle_home",          # bundle_home,
                                                  default,                # tmux_bin,
                                                  default,                # su_bin,
                                                  "/usr/bin/htop",            # command,
                                                  "top",                # session_name,
                                                  "!any",                # context_remove_session,
                                                  "cmdln",                # runas,
                                                  "@($(this.bundle).tmux_config)",                # tmux_config,
                                                  "/tmp/tmux.conf",       # tmux_config_path,
                                                  "!any",                # context_remove_config
                                                  "any"                 # context_conf_emptyfirst
                                                );
}


